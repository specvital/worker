# ============================================
# specvital-worker Environment Variables
# ============================================
# Copy this file to .env and fill in the values

# --------------------------------------------
# Required (All environments)
# --------------------------------------------

# PostgreSQL connection URL
DATABASE_URL=postgres://user:password@host:5432/dbname?sslmode=disable

# Encryption key for OAuth token storage (base64 encoded, 32 bytes)
# Generate: openssl rand -base64 32
ENCRYPTION_KEY=

# --------------------------------------------
# Local Development (Optional)
# --------------------------------------------
# Used in devcontainer, points to local services

# LOCAL_DATABASE_URL=postgres://postgres:postgres@local-postgres:5432/specvital?sslmode=disable

# --------------------------------------------
# Production (Railway/Cloud)
# --------------------------------------------
# These are typically injected by the platform

# DATABASE_URL=postgres://user:password@postgres.railway.internal:5432/railway

# --------------------------------------------
# Fairness Configuration
# --------------------------------------------
# Per-user concurrent job limits and snooze parameters

# Enable/disable fairness control (default: true)
FAIRNESS_ENABLED=true

# Per-tier concurrent job limits
FAIRNESS_FREE_LIMIT=1          # Free tier users (default: 1)
FAIRNESS_PRO_LIMIT=3           # Pro/ProPlus tier users (default: 3)
FAIRNESS_ENTERPRISE_LIMIT=5    # Enterprise tier users (default: 5)

# Snooze parameters when limit exceeded
FAIRNESS_SNOOZE_DURATION=30s   # Base delay before retry (default: 30s)
FAIRNESS_SNOOZE_JITTER=10s     # Random jitter (0~10s) to prevent thundering herd (default: 10s)

# --------------------------------------------
# SpecView Batch API (Experimental)
# --------------------------------------------
# Large repository processing via Gemini Batch API

# Enable/disable Batch API mode (default: false)
SPECVIEW_USE_BATCH_API=false

# Minimum test count to trigger Batch mode (default: 10000)
SPECVIEW_BATCH_THRESHOLD=10000

# Polling interval for Batch job status (default: 30s)
SPECVIEW_BATCH_POLL_INTERVAL=30s
